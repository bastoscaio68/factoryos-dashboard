# RD-001 - Trading Dashboard Backend

**Projeto:** PROJ-004-trading-dashboard  
**Versão:** 1.0.0  
**Data:** 2026-02-12  
**Status:** Aprovado

---

## 1. Visão Geral

Backend API para Trading Dashboard com análise de mercado, detecção de regimes e recomendações de setup.

## 2. Requisitos Funcionais

### 2.1 Models
- **User**: id, email, name, password_hash, created_at, updated_at
- **Trade**: id, user_id, symbol, entry_price, exit_price, quantity, side, status, created_at
- **PerformanceMetric**: id, user_id, trade_id, win_rate, profit_factor, expectancy, period
- **MarketRegime**: id, symbol, regime_type, confidence, start_time, end_time, features
- **PortfolioHistory**: id, user_id, total_value, holdings, timestamp

### 2.2 Endpoints

#### Auth
- `POST /api/v1/auth/register` - Registro
- `POST /api/v1/auth/login` - Login
- `POST /api/v1/auth/refresh` - Refresh token
- `POST /api/v1/auth/logout` - Logout

#### Trades
- `GET /api/v1/trades` - Listar trades
- `POST /api/v1/trades` - Criar trade
- `GET /api/v1/trades/{id}` - Detalhe trade
- `PUT /api/v1/trades/{id}` - Atualizar trade
- `DELETE /api/v1/trades/{id}` - Deletar trade

#### Portfolio
- `GET /api/v1/portfolio` - Ver portfólio
- `GET /api/v1/portfolio/history` - Histórico
- `GET /api/v1/portfolio/holdings` - Holdings atuais

#### Analysis
- `GET /api/v1/analysis/performance` - Performance metrics
- `GET /api/v1/analysis/setup-recommendations` - Recomendações
- `GET /api/v1/analysis/market-regimes` - Regime atual

#### Market
- `GET /api/v1/market/price/{symbol}` - Preço atual
- `GET /api/v1/market/history/{symbol}` - Histórico
- `GET /api/v1/market/multi` - Múltiplos ativos

### 2.3 WebSocket
- `ws://host/ws/market` - Stream preços
- `ws://host/ws/portfolio` - Stream portfólio
- `ws://host/ws/alerts` - Stream alertas

## 3. Requisitos Não Funcionais

- PostgreSQL com SQLAlchemy
- Cliente async para CoinGecko API
- Engine de detecção de regime de mercado
- Engine de recomendação de setup
- Autenticação JWT
- Rate limiting

## 4. Tech Stack

- Python 3.11+
- FastAPI
- SQLAlchemy 2.0
- Pydantic v2
- Alembic (migrations)
- Celery (tasks async)
- Redis (cache)

## 5. Entregáveis

- Código fonte em `src/`
- Documentação de API (OpenAPI)
- Dockerfiles
- docker-compose.yml
- README.md
